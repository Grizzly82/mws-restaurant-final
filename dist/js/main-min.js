let restaurants,neighborhoods,cuisines;var map,markers=[];document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,n=t.selectedIndex,s=e[a].value,r=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(s,r,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),a=document.createElement("figure");a.className="restaurant-figure";const n=document.createElement("picture"),s=DBHelper.imageUrlForRestaurant(e),r=document.createElement("source");r.media="(min-width: 750px)",r.srcset=s.replace(".jpg","-800_large_1X.jpg"),r.type="image/jpeg",n.append(r);const o=document.createElement("source");o.media="(min-width: 500px)",o.srcset=s.replace(".jpg","-600_medium.jpg"),o.type="image/jpeg",n.append(o);const c=document.createElement("source");c.srcset=s.replace(".jpg"),r.type="image/jpeg",n.append(c);const i=document.createElement("figCaption");i.className="restaurant-figCaption",i.innerHTML=e.name+" restaurant";const l=document.createElement("img");l.className="restaurant-img",l.src=s.replace(".jpg","-315_small.jpg"),l.alt="Photo at the "+e.name+" restaurant",n.append(l),a.append(n),a.append(i),t.append(a);const d=document.createElement("h1");d.innerHTML=e.name,t.append(d);const u=document.createElement("button");u.innerHTML="&#9733;",u.classList.add("fav_btn"),u.onclick=function(){const t=!e.is_favorite;DBHelper.updateFavouriteStatus(e.id,t),e.is_favorite=!e.is_favorite,changeFavElementClass(u,e.is_favorite)},changeFavElementClass(u,e.is_favorite),t.append(u);const m=document.createElement("p");m.innerHTML=e.neighborhood,t.append(m);const p=document.createElement("p");p.innerHTML=e.address,t.append(p);const f=document.createElement("label");f.className="hidden",f.setAttribute("for","restaurant"+e.id),f.innerHTML="View Details of "+e.name+" restaurant",t.append(f);const g=document.createElement("button");return g.innerHTML="View Details",g.id="restaurant"+e.id,g.setAttribute("onclick","location.href='"+DBHelper.urlForRestaurant(e)+"'"),t.append(g),t}),changeFavElementClass=((e,t)=>{t?(console.log("toggle yes upd"),e.classList.remove("favorite_no"),e.classList.add("favorite_yes"),e.setAttribute("aria-label","remove as favorite")):(e.classList.remove("favorite_yes"),e.classList.add("favorite_no"),e.setAttribute("aria-label","mark as favorite"))}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});